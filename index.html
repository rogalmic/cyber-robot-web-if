<!DOCTYPE html>
<html lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">    
    <title>Cyber Robot Chrome controller</title>
    <script type="text/javascript">
      window.addEventListener('error', function(error) {
        var isChrome = !!window.chrome
        if (!isChrome) {
          console.error(error);
          alert(error.message + ' (Your browser may not support this feature.)');
          error.preventDefault();
        }
      });
    </script>
    
    <style>
    </style>
</head>

<body>
    
<script>
function onButtonClick() {
var encoder = new TextEncoder('utf-8');
var message = document.getElementById('message').value;
var serviceUuid = '0000fff3-0000-1000-8000-00805f9b34fb';
var characteristicUuid = '0000fff5-0000-1000-8000-00805f9b34fb';

navigator.bluetooth.requestDevice({acceptAllDevices: true})
.then(device => device.gatt.connect())
.then(server => server.getPrimaryService(serviceUuid))
.then(service => service.getCharacteristic(characteristicUuid))
.then(characteristic => {
  var forwardCommand = encoder.encode(message);
  return characteristic.writeValue(forwardCommand);
})
.then(_ => {
  console.log('Command sent.');
})
.catch(error => { console.log(error); });
}
</script>

<ul>
<li>move = `12D${p1}S${p2}`</li>
<li>sound = `56${p1}E`</li>
<li>led = `78${p1}`</li>
<li>stop = `99SP`</li>
</ul>

<input type="text" id="message" />
<input type="button" onclick="javascript:onButtonClick()" value="Send to robot" />

</body>
</html>
